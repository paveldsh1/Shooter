<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CS 1.0</title>
    <style>
        body {
            background: black;
            color: #00ff00;
            font-family: monospace;
        }

        textarea {
            width: 100%;
            height: 600px;
            background: black;
            color: #00ff00;
        }

        input {
            width: 100%;
            background: black;
            color: #00ff00;
        }
    </style>
</head>
<body>
    <textarea id="output" readonly></textarea><br />

    <script>
        const output = document.getElementById("output");

        const protocol = location.protocol === "https:" ? "wss://" : "ws://";
        const ws = new WebSocket(protocol + location.host + "/ws");

        ws.onopen = () => {
            output.innerText = "WebSocket connected";
        };

        ws.onmessage = e => {
            output.innerText = e.data;
            console.log(123);
        };

        ws.onerror = e => {
            output.innerText = "WebSocket error";
        };

        document.addEventListener("keydown", e => {
            if (ws.readyState === WebSocket.OPEN) {
                ws.send(e.code);
                console.log(555);
            }
        });
    </script>
</body>
</html>