<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CS 1.0</title>
    <style>
        body {
            background: black;
            color: #00ff00;
            font-family: Consolas, "Cascadia Mono", monospace;
        }

        textarea {
            width: 120ch; /* 120 columns */
            height: calc(40 * 1em); /* 40 rows */
            line-height: 1em;
            background: black;
            color: #00ff00;
            border: none;
            outline: none;
            resize: none;
            overflow: hidden;
            font-family: inherit;
            font-size: 14px;
        }

        input {
            width: 100%;
            background: black;
            color: #00ff00;
        }
    </style>
</head>
<body>
    <textarea id="output" readonly rows="40" cols="120" wrap="off" spellcheck="false"></textarea><br />

    <script>
        const output = document.getElementById("output");

        const protocol = location.protocol === "https:" ? "wss://" : "ws://";
        const ws = new WebSocket(protocol + location.host + "/ws");

        ws.onopen = () => {
            output.value = "WebSocket connected";
        };

        ws.onmessage = e => {
            output.value = e.data;
            console.log(123);
        };

        ws.onerror = e => {
            output.value = "WebSocket error";
        };

        document.addEventListener("keydown", e => {
            if (ws.readyState === WebSocket.OPEN) {
                ws.send(e.code);
                console.log(555);
            }
        });
    </script>
</body>
</html>